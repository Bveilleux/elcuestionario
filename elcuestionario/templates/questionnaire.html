{% extends "layout.html" %}
{% set page_title = 'Questionnaire' %}
{% block body %}

      <form action="{{ url_for('evaluate', _method='POST') }}" method="post">

        {% if submitted -%}
        <section class="notifications">
          <fieldset>
            <p>You have answered only <strong>{{ questionnaire.total_questions_answered }} of {{ questionnaire.get_questions()|length }}</strong> questions so far.</p>
            <p>Please answer the remaining <strong>{{ questionnaire.total_questions_unanswered }}</strong> question(s) for final evaluation.</p>
          </fieldset>
        </section>
        {% endif -%}

        <section class="name">
          <fieldset>
            <h2>What's your name? <small>(optional)</small></h2>
            <p><input type="text" name="username" value="{{ username }}" maxlength="40"/></p>
          </fieldset>
        </section>

        {% for question in questionnaire.get_questions() %}
        <section class="question">
          <fieldset>
            <h2>{{ loop.index }}. {{ question.text }}</h2>
            {%- if submitted and not question.answered %}
            <p class="notification">Please answer this question.</p>
            {%- endif %}
            <ul>
            {%- for answer in question.get_answers()|shuffled %}
              <li><label><input type="radio" name="q_{{ question.hash }}" value="a_{{ answer.hash }}"{% if question.is_answer_selected(answer) %} checked="checked"{% endif %}/>{{ answer.text }}</label></li>
            {%- endfor %}
            </ul>
          </fieldset>
        </section>
        {% endfor %}

        <div class="button-wrapper">
          <button>Evaluate</button>
        </div>

      </form>

{%- endblock body %}
